{% extends "base.html" %}
{% block body %}

<div class="row">
    <div class="page-header">
        <h2 id="office_hours"><i class="fa fa-trophy"></i> Semester Leaderboard</h2>
    </div>
</div>

<div class="row">
    This semester we're going to try something new. Throughout the course of the semester your challenges (and potentially a few other assignments) will gain you points based on four different metrics. Based on these points you'll be ranked against your classmates and will be entered in a competition for a small pool of bonus points. Your final submission for each challenge will be used to calculate points based on the formula below:
</div>

<br>

<div class="row">
    <div class="alert alert-info">
        <b>Scoring Formula:</b> 
        <pre>0.4 * Runtime + 0.3 * Submission Time + 0.2 * Lint Score + 0.1 * Code Score</pre>
    </div>
</div>

<div class="row">
    In addition to the points given by the formula above, there are three more bonus points available for being the top in the three categories: Runtime, Submission Time, Lint Score. These are indicated by:
    <p class="label label-warning">Speedster</p>
    <p class="label label-info">Early Bird</p>
    <p class="label label-success">Prettiest</p>
</div>

<br>

<div class="row">
    <div class="alert alert-danger">
        <b>Stakes:</b> 5 bonus points for 1st place, 2 bonus points for 2nd, and 1 bonus point for 3rd, 4th, or 5th.
    </div>
</div>



<div class="row">
    <table class="table condensed table-striped" border="2px solid black">
        <tr>
            <th>Rank</th>
            <th>Total Points</th>
            <th>Student ID</th>
            <th>Average Assignment Points</th>
            <th>Current Rewards</th>
            <th>Challenges</th>
            <th>Progress</th>
        </tr>
        {% for entry in leaderboard %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>{{ "%.2f"|format(entry.total_score) }}</td>
            <td>{{ entry.student_id }}</td>
            <td>{{ "%.2f"|format(entry.average_score) }}</td>
            <td>
                {% if entry.bonus_points == 4 %}
                    {% set assignment_label = 'success' %}
                    <p class="label label-{{ assignment_label }}">1st Place</p>
                {% elif entry.bonus_points == 2 %}
                    {% set assignment_label = 'warning' %}
                    <p class="label label-{{ assignment_label }}">2nd Place</p>
                {% elif entry.bonus_points == 1 %}
                    {% set assignment_label = 'info' %}
                    <p class="label label-{{ assignment_label }}">3rd Place</p>
                {% endif %}
                {% for tag in entry.tags %}
                    {% if tag == 'Fastest Coder' %}
                        {% set assignment_label = 'warning' %}
                        <p class="label label-{{ assignment_label }}">Speedster</p>
                    {% elif tag == 'Early Bird' %}
                        {% set assignment_label = 'info' %}
                        <p class="label label-{{ assignment_label }}">Early Bird</p>
                    {% elif tag == 'Lint Master' %}
                        {% set assignment_label = 'success' %}
                        <p class="label label-{{ assignment_label }}">Prettiest</p>
                    {% endif %}
                {% endfor %}
            </td>
            <td>{{ entry.assignments_completed }} / 23</td>
            <td>
                <div class="progress-bar">
                    <div class="progress" style="width: {{ (entry.assignments_completed / 23 * 100)|round }}%"></div>
                </div>
            </td>
        </tr>
        {% endfor %}
    </table>
</div>

<style>
.bonus {
    color: #4CAF50;
    font-weight: bold;
}
.progress-bar {
    width: 100%;
    height: 20px;
    background-color: #f0f0f0;
    border-radius: 10px;
    overflow: hidden;
}
.progress {
    height: 100%;
    background-color: #4CAF50;
    transition: width 0.5s ease-in-out;
}
</style>

<div class="row">
    <div class="alert alert-success">
        <b>Note:</b> You have all been assigned an anonymous identifier. If you're interested in seeing where you stack up just contact me and I will send it to you!
    </div>
</div>

{% endblock %}